# ShiftF1Voice

cursorとか使っているときにボイス入力がしたい！けどwindowsにはいい感じのボイス入力がなかったので自力で作ってみた。

割り当てたショートカットキーが押されると録音を開始して、もう一度押すと喋った内容を文字起こしして今選択しているウィンドウに入力する感じ。
ショートカットキーは　マクロパッド（追加のキーボード）から使う想定。
とてもショボイので誰かがもっといい感じのを作ってくれたらいいなと思っている。

Exeファイルを作るときは
pyinstaller voice_input_app.spec

## 主な機能

- **Shift-F24キーによる音声入力**: Shift-F24（カスタマイズ可能）を押して録音開始、もう一度押して文字起こし
- **自動テキスト挿入**: 文字起こしされたテキストが現在アクティブなウィンドウに自動挿入
- **GPT-4oによる追加指示**: Shift-F22を押すことで、GPT-4に追加の指示や編集を依頼可能
- **テキスト翻訳機能**: Shift-F21を押すことで、現在選択されて色が反転しているテキストの翻訳が可能
- **キャンセル機能**: Shift-F23を押すことで、現在の操作をキャンセル
- **テキストバックアップ**: 変換されたテキストの自動バックアップ
- **エラーハンドリング**: 包括的なエラー処理とユーザーへのフィードバック
- **カスタマイズ設定**: 設定ファイルによる柔軟なカスタマイズ

## インストール

実行ファイルを作成する場合:
```bash
pyinstaller voice_input_app.spec
```

## ファイル構成

- `voice_input_app.py`: メインアプリケーションのエントリーポイント
- `recorder.py`: 音声録音機能を提供
- `transcriber.py`: 音声をテキストに変換する機能を提供
- `utils.py`: ユーティリティ関数とエラーハンドリング
- `config.json`: ショートカットキーを変えたいとき　や　バックアップ先などの設定

## 動作説明

1. **アプリケーションの起動**
   - `voice_input_app.py`を実行するか、実行ファイルを起動します
   - タスクトレイにアイコンが表示されます

2. **音声入力の使用**
   - Shift-F24キーを押して録音を開始します
   - 再度Shift-F24キーを押すと録音が停止し、テキストに変換されます
   - 変換されたテキストが自動的にアクティブなウィンドウに挿入されます

3. **追加機能の使用**
   - Shift-F22: テキストに対してGPT-4に追加の指示を出せます
   - Shift-F21: 選択状態のテキストを翻訳（今まともに動いてない）
   - Shift-F23: 現在の操作をキャンセルします

## エラーハンドリング

- **API通信エラー**
  - 文字起こしの際にエラーが発生した場合、エラーメッセージを表示し、処理を中断します

- **バックアップエラー**
  - テキストの保存時にエラーが発生した場合、エラーメッセージを表示します

## セキュリティとプライバシー

- **APIキーの管理**
  - OpenAI APIキーを環境変数`OPENAI_API_KEY`に設定する必要があります
  - Windowsの場合：
    1. システムの環境変数設定を開く
    2. 新しいユーザー環境変数を追加
    3. 変数名：`OPENAI_API_KEY`
    4. 変数値：OpenAIから取得したAPIキー
  - APIキーはOpenAIのウェブサイト（https://platform.openai.com/）から取得できます

- **音声データの扱い**
  - 処理後、音声ファイルは削除されます

## カスタマイズ

- **設定オプション**
  - `config.json`で以下の設定が可能です：
    - ショートカットキー
    - バックアップ保存先
    - バックアップ保持期間

## 注意点
- **プラットフォーム互換性**
  - 現在はWindows向けに最適化されています

## ライセンス
- このソフトウェアは、MITライセンスの下で提供されています。