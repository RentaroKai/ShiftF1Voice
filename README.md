# ShiftF1Voice

cursorとか使っているときにボイス入力がしたい！
けどwindowsにはいい感じのボイス入力がなかったので自力で作ってみた

## 使用方法

 C:\Users\<ユーザー名>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
にVoiceInputLauncher.exeへのショートカットを入れておくと1-1をスキップできる
動かないときは　pythonのパスがおかしいかもしれない


1. **起動手順（重要）**
   1. まず、ランチャーを起動します：
      ```
      VoiceInputLauncher.exe　または　ahk
      ```
   2. ランチャーが起動したら、以下のホットキーが使用可能になります：
   (キー割り当てはconfig.jsonで変更可能)   
      - `Shift + F1`: 起動と録音開始/停止（アプリが未起動の場合は起動になる）
      - `Shift + F2`: キャンセル
      - `Shift + F3`: GPT-4に追加指示
      - `Shift + F4`: 今選んでるウィンドウのテキスト消去

2. **注意事項**
   - 必ずランチャーを先に起動してください
   - ホットキーが効かない場合は、ランチャーが起動しているか確認してください


## 設定
- `config.json`でホットキーなどの設定をカスタマイズ可能
- バックアップは自動的に保存されます

## 機能
- ショートカットキーによる即時録音開始
- 音声認識による文字起こし
- バックアップ機能
- 後処理機能（OpenAI APIによる文章の編集）

## 主な機能

- **Shift-F1キーによる音声入力**: Shift-F1（カスタマイズ可能）を押して録音開始、もう一度押して文字起こし
- **自動テキスト挿入**: 文字起こしされたテキストが現在アクティブなウィンドウに自動挿入
- **GPT-4による追加指示**: Shift-F3を押すことで、GPT-4に追加の指示や編集を依頼可能
- **キャンセル機能**: Shift-F2を押すことで、現在の操作をキャンセル
- **テキストバックアップ**: 変換されたテキストの自動バックアップ
- **エラーハンドリング**: 包括的なエラー処理とユーザーへのフィードバック
- **カスタマイズ設定**: 設定ファイルによる柔軟なカスタマイズ

## インストール

AutoHotkeyの実行ファイルを作成する場合:
ツールからahkファイルを指定してください

pythonの実行ファイルを作成する場合:
pyinstaller voice_input_app.spec


## ファイル構成

- `voice_input_app.py`: メインアプリケーションのエントリーポイント
- `recorder.py`: 音声録音機能を提供
- `transcriber.py`: 音声をテキストに変換する機能を提供
- `utils.py`: ユーティリティ関数とエラーハンドリング
- `config.json`: ショートカットキーやバックアップ先などの設定

## 動作説明

1. **アプリケーションの起動**
   - `voice_input_app.py`を実行するか、実行ファイルを起動します
   - タスクトレイにアイコンが表示されます

2. **音声入力の使用**
   - Shift-F1キーを押してツール立ち上げ
   - Shift-F1キーを押して録音を開始します
   - 再度Shift-F1キーを押すと録音が停止し、テキストに変換されます
   - 変換されたテキストが自動的にアクティブなウィンドウに挿入されます

3. **追加機能の使用**
   - Shift-F3: テキストに対してGPT-4に追加の指示を出せます
   - Shift-F2: 現在の操作をキャンセルします

## エラーハンドリング

- **API通信エラー**
  - 文字起こしの際にエラーが発生した場合、エラーメッセージを表示し、処理を中断します

- **バックアップエラー**
  - テキストの保存時にエラーが発生した場合、エラーメッセージを表示します

## セキュリティとプライバシー

- **APIキーの管理**
  - 環境変数`OPENAI_API_KEY`からAPIキーを取得します

- **音声データの扱い**
  - 処理後、音声ファイルは削除されます

## カスタマイズ

- **設定オプション**
  - `config.json`で以下の設定が可能です：
    - ショートカットキー
    - バックアップ保存先
    - バックアップ保持期間

## 注意点

- **プラットフォーム互換性**
  - 現在はWindows向けに最適化されています
